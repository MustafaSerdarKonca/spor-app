<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Spor App</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Spor App">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#1c1c1e" media="(prefers-color-scheme: dark)">
    <link rel="apple-touch-icon" href="assets/icons/icon-192.png">

    <link rel="stylesheet" href="css/styles.css">
</head>

<body>

    <div id="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>Spor App</h1>
                <p>AntrenmanlarÄ±nÄ± takip et.</p>
            </div>

            <!-- Login Form -->
            <form id="login-form">
                <div class="form-group">
                    <input type="email" id="login-email" class="form-control" placeholder="E-posta" required
                        autocomplete="email">
                </div>
                <div class="form-group">
                    <input type="password" id="login-password" class="form-control" placeholder="Åžifre" required
                        autocomplete="current-password">
                </div>
                <button type="submit" class="btn-block">GiriÅŸ Yap</button>
                <div class="auth-divider">veya</div>
                <button type="button" class="btn-block btn-google" id="btn-google-login">
                    <svg viewBox="0 0 48 48" width="24" height="24">
                        <g>
                            <path fill="#EA4335"
                                d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z">
                            </path>
                            <path fill="#4285F4"
                                d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z">
                            </path>
                            <path fill="#FBBC05"
                                d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z">
                            </path>
                            <path fill="#34A853"
                                d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z">
                            </path>
                            <path fill="none" d="M0 0h48v48H0z"></path>
                        </g>
                    </svg>
                    <span>Google ile GiriÅŸ Yap</span>
                </button>
                <button type="button" class="btn-text" onclick="toggleAuthMode()">HesabÄ±n yok mu? KayÄ±t Ol</button>
            </form>

            <!-- Register Form -->
            <form id="register-form" style="display:none">
                <div class="form-group">
                    <input type="email" id="reg-email" class="form-control" placeholder="E-posta" required
                        autocomplete="email">
                </div>
                <div class="form-group">
                    <input type="password" id="reg-password" class="form-control" placeholder="Åžifre" required
                        autocomplete="new-password">
                </div>
                <button type="submit" class="btn-block">KayÄ±t Ol</button>
                <button type="button" class="btn-text" onclick="toggleAuthMode()">Zaten hesabÄ±n var mÄ±? GiriÅŸ
                    Yap</button>
            </form>
        </div>
    </div>

    <!-- Main App (Initially Hidden) -->
    <div id="app-container" style="display: none;">
        <header>
            <div class="header-top"
                style="display:flex; justify-content:space-between; align-items:center; padding: 0 16px; height: 40px;">
                <span style="font-weight:700; font-size:18px;">SporApp</span>
                <div style="display:flex; gap:10px;">
                    <button id="btn-enable-notify" class="btn-icon" style="font-size:18px;"
                        title="Bildirimleri AÃ§">ðŸ””</button>

                    <button id="btn-logout" class="btn-text"
                        style="font-size:14px; color:var(--primary);">Ã‡Ä±kÄ±ÅŸ</button>
                </div>
            </div>
            <div class="day-tabs">
                <!-- Populated by JS -->
            </div>
        </header>

        <main id="exercise-list">
            <!-- populated by JS -->
        </main>

        <!-- Floating Action Button -->
        <button class="fab" id="fab-add" aria-label="Hareket Ekle">+</button>

        <!-- Modal -->
        <div class="modal-overlay" id="modal-overlay">
            <div class="modal">
                <div class="modal-header">
                    <h2 class="modal-title" id="modal-title">Yeni Hareket</h2>
                    <button class="btn-icon" id="close-modal">âœ•</button>
                </div>
                <form id="exercise-form">
                    <div class="form-group">
                        <label>Hareket AdÄ±</label>
                        <input type="text" id="inp-name" class="form-control" placeholder="Ã–rn: Squat" required>
                    </div>
                    <div class="form-group">
                        <label>Kas Grubu / Etiket (Opsiyonel)</label>
                        <input type="text" id="inp-tag" class="form-control" placeholder="Ã–rn: Bacak">
                    </div>
                    <div class="form-group">
                        <label>Not (Opsiyonel)</label>
                        <input type="text" id="inp-note" class="form-control" placeholder="Ã–rn: 4 set 12 tekrar">
                    </div>
                    <div class="form-group">
                        <label>GÃ¶rsel Ekle (Opsiyonel)</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="inp-image" accept="image/*" class="form-control-file">
                            <div id="image-preview" class="image-preview-box">GÃ¶rsel SeÃ§</div>
                        </div>
                    </div>
                    <button type="submit" class="btn-block">Kaydet</button>
                </form>
            </div>
        </div>

    </div>

    <!-- Script -->
    <script type="module" src="js/app.js"></script>
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(reg => {
                console.log('SW Registered');

                // If there's an update ready, it will install and activate thanks to skipWaiting() in sw.js
                // Then simple page reload or user prompt is needed.
                // For this app, we will auto-reload if it's a new version content update.
                reg.addEventListener('updatefound', () => {
                    const newWorker = reg.installing;
                    newWorker.addEventListener('statechange', () => {
                        if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                            // New content is available.
                            console.log('New update available.');
                        }
                    });
                });
            }).catch(e => console.error('SW Fail', e));

            // Reload page when new SW takes control
            let refreshing;
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (refreshing) return;
                window.location.reload();
                refreshing = true;
            });
        }
    </script>
</body>

</html>